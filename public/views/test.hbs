{{!--<!DOCTYPE html>--}}
<html lang="en">
  <head>
    <title>Sugar Lift</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Poppins"
    />
 <link rel="shortcut icon" href="https://sugar-lift.sites.tjhsst.edu/img/favicon.ico" type="image/x-icon">
    
    <style>
.workout-details {
  margin-top: 0px;
  margin-bottom: 0px;
  padding: 10px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 5px;
  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
}

.workout-detail-row {
  margin-bottom: 10px;
  display: flex;
  align-items: center;

}

.workout-detail-row:first-of-type {
  margin-top: 10px;
}

.workout-detail-row .lift {
  font-weight: bold;
  flex: 1;
  color: #444;
}

.workout-detail-row .weight {
  margin-right: 20px;
  color: #666;
}

.workout-detail-row .sets-reps {
  color: #888;
  font-size: 14px;
}


      body,h1,h2,h3,h4,h5 {font-family: "Poppins", sans-serif} body
      {font-size:16px;} .w3-half
      input{margin-bottom:-6px;margin-top:16px;opacity:1;cursor:pointer}
      .w3-half input:hover{opacity:0.6}
      table {
          margin-top:5px;
  border-collapse: collapse;
  width: 100%;
  margin-bottom: 5px;
}

th,
td {
  text-align: left;
  padding: 12px;
  border: 1px solid #ddd;
}

th {
  background-color: #f2f2f2;
  font-weight: bold;
}

tr:nth-child(even) {
  background-color: #f2f2f2;
}

tr:hover {
  background-color: #ddd;
}

    </style>
  </head>
  <body>

    <!-- Sidebar/menu -->
    <nav
      class="w3-sidebar w3-red w3-collapse w3-top w3-large w3-padding"
      style="z-index:3;width:300px;font-weight:bold;"
      id="mySidebar"
    ><br />
      <a
        href="javascript:void(0)"
        onclick="w3_close()"
        class="w3-button w3-hide-large w3-display-topleft"
        style="width:100%;font-size:22px"
      >Close Menu</a>
      <div class="w3-container">

        <h3 class="w3-padding-64"><a
            href="https://sugar-lift.sites.tjhsst.edu/logout"
          >Logout</a></h3>

      </div>
      <div class="w3-bar-block">
        {{!<a href="#" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Home</a> }}
        <a
          href="#chart"
          onclick="w3_close()"
          class="w3-bar-item w3-button w3-hover-white"
        >Chart</a>
        <a
          href="#exercise"
          onclick="w3_close()"
          class="w3-bar-item w3-button w3-hover-white"
        >Exercise</a>
        <a
          href="#history"
          onclick="w3_close()"
          class="w3-bar-item w3-button w3-hover-white"
        >History</a>
        <a
          href="#background"
          onclick="w3_close()"
          class="w3-bar-item w3-button w3-hover-white"
        >Background</a>
        <a
          href="#contact"
          onclick="w3_close()"
          class="w3-bar-item w3-button w3-hover-white"
        >Contact</a>
      </div>
    </nav>

    <!-- Top menu on small screens -->
    <header
      class="w3-container w3-top w3-hide-large w3-red w3-xlarge w3-padding"
    >
      <a
        href="javascript:void(0)"
        class="w3-button w3-red w3-margin-right"
        onclick="w3_open()"
      >â˜°</a>

      <a href="https://sugar-lift.sites.tjhsst.edu/logout">Logout</a>

    </header>

    <!-- Overlay effect when opening sidebar on small screens -->
    <div
      class="w3-overlay w3-hide-large"
      onclick="w3_close()"
      style="cursor:pointer"
      title="close side menu"
      id="myOverlay"
    ></div>

    <!-- !PAGE CONTENT! -->
    <div class="w3-main" style="margin-left:340px;margin-right:40px">

      <!-- Header -->
      <div class="w3-container" style="margin-top:80px" id="chart">
        <h1 class="w3-jumbo"><b>Sugar Lift</b></h1>
        <h1 class="w3-xxxlarge w3-text-red"><b>Chart.</b></h1>
        <hr style="width:50px;border:5px solid red" class="w3-round" />

        <canvas id="myChart" />

        <input type="hidden" id="dS" value={{datas}} />
        <input type="hidden" id="lS" value={{labels}} />
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            var datas = document.getElementById("dS").value.split(",").map(Number);
            var labels = document.getElementById("lS").value.split(",");
            
            const ctx = document.getElementById('myChart');
            const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Blood Sugar',
                    data: datas,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    x:{
                        title:{
                            display: true,
                            text: 'Time'
                        }
                    },
                    y:{
                        beginAtZero: false,
                        title:{
                            display: true,
                            text: 'mg/dl'
                        }
                    }
                }
            }
        });
            
            
        </script>

      </div>
      <!-- Exercise -->
      <div class="w3-container" id="exercise" style="margin-top:75px">
        <h1 class="w3-xxxlarge w3-text-red"><b>Exercise.</b></h1>
        <hr style="width:50px;border:5px solid red" class="w3-round" />

        {{!<form action="https://sugar-lift.sites.tjhsst.edu/exercise">}}
        {{!	<label for="exerciseType">Choose your exercise:</label>}}

        {{!    <select name="exerciseType" id="exerciseType">}}
        {{!      <option value="cardio">Cardio</option>}}
        {{!      <option value="weightlifting">Weightlifting</option>}}
        {{!    </select>}}
        {{!    <input type="submit" name="GO" value="Go"/>}}
        {{!</form> }}

        <form action="https://sugar-lift.sites.tjhsst.edu/exercise">
          <h3 class="w3-xlarge w3-padding-32">Select your exercise:</h3>
          <!-- Photo grid (modal) -->
          <div class="w3-row-padding">
            <div class="w3-half">
              <input
                type="image"
                src="https://sugar-lift.sites.tjhsst.edu/img/biking.png"
                style="width:50%"
                onclick="onClick(this)"
                alt="Cycling"
                name="cycling"
              />
              <input
                type="image"
                src="https://sugar-lift.sites.tjhsst.edu/img/walking.png"
                style="width:50%"
                onclick="onClick(this)"
                alt="Jogging"
                name="jogging"
              />
              <input
                type="image"
                src="https://sugar-lift.sites.tjhsst.edu/img/swimming.png"
                style="width:50%"
                onclick="onClick(this)"
                alt="Swimming"
                name="swimming"
              />
            </div>

            <div class="w3-half">
              <input
                type="image"
                src="https://sugar-lift.sites.tjhsst.edu/img/sprinting.png"
                style="width:50%"
                onclick="onClick(this)"
                alt="Sprinting"
                name="sprinting"
              />
              <input
                type="image"
                src="https://sugar-lift.sites.tjhsst.edu/img/weightlifting.png"
                style="width:50%"
                onclick="onClick(this)"
                alt="Weightlifting"
                name="weightlifting"
              />
              <input
                type="image"
                src="https://sugar-lift.sites.tjhsst.edu/img/basketball.png"
                style="width:50%"
                onclick="onClick(this)"
                alt="Sports"
                name="sports"
              />
            </div>
          </div>
        </form>

      </div>

      <!-- History -->
<div class="w3-container" id="history" style="margin-top:75px">
  <h1 class="w3-xxxlarge w3-text-red"><b>History.</b></h1>
  <hr style="width:50px;border:5px solid red" class="w3-round" />
  <table>
    <thead>
      <tr id="tableSuperHead">
        <th>Date</th>
        <th>Workout</th>
        <th>BG Before</th>
        <th>BG After</th>
      </tr>
    </thead>
    <tbody>
      {{#each cal}}
        <tr id="tableHead" onclick="showDetails(this)">
          <td>{{this.dat}}</td>
          <td>{{this.ex}}</td>
          <td>{{this.bef}}</td>
          <td>{{this.af}}</td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</div>
<script>
var count = 0;
function showDetails(row) {
  var details = row.querySelector('.workout-details');
  if (details) {
    // If details already present, remove them from the row
    details.remove();
    count -= 1;
    if (count == 0){
        document.getElementById("tableSuperHead").children[4].remove();
    }
    return;
  }
  count += 1;


  details = document.createElement("div");
  details.classList.add("workout-details");

  var table = document.createElement("table");
  var headerRow = document.createElement("tr");
  var liftHeader = document.createElement("th");
  var weightHeader = document.createElement("th");
  var setsHeader = document.createElement("th");
  var repsHeader = document.createElement("th");
  liftHeader.innerHTML = "Exercise";
  weightHeader.innerHTML = "Weight";
  setsHeader.innerHTML = "Sets";
  repsHeader.innerHTML = "Reps";
  headerRow.appendChild(liftHeader);
  headerRow.appendChild(weightHeader);
  headerRow.appendChild(setsHeader);
  headerRow.appendChild(repsHeader);
  table.appendChild(headerRow);

  fetch(`/workoutData?date=${row.children[0].innerText}&exercise=${row.children[1].innerText}`)
    .then(response => {
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      return response.json();
    })
    .then(data => {
      console.log(data);
      var workoutData = data;
      for (var i = 0; i < workoutData.length; i++) {
        var lift = workoutData[i].lift;
        var weight = workoutData[i].weight;
        var sets = workoutData[i].sets;
        var reps = workoutData[i].reps;

        var exerciseRow = document.createElement("tr");
        var liftData = document.createElement("td");
        var weightData = document.createElement("td");
        var setsData = document.createElement("td");
        var repsData = document.createElement("td");

        liftData.innerHTML = lift;
        weightData.innerHTML = weight + " lbs";
        setsData.innerHTML = sets;
        repsData.innerHTML = reps;

        exerciseRow.appendChild(liftData);
        exerciseRow.appendChild(weightData);
        exerciseRow.appendChild(setsData);
        exerciseRow.appendChild(repsData);

        table.appendChild(exerciseRow);
      }

      details.appendChild(table);
      row.appendChild(details);
      
        if (count == 1){
        var newHeader = document.createElement("th");
        newHeader.innerHTML = "Workout Details";
        document.getElementById("tableSuperHead").appendChild(newHeader);
    }
    })
    .catch(error => {
      console.error('There was a problem fetching the workout data:', error);
    });
}

</script>



      <!-- Background -->
      <div class="w3-container" id="background" style="margin-top:75px">
        <h1 class="w3-xxxlarge w3-text-red"><b>Background.</b></h1>
        <hr style="width:50px;border:5px solid red" class="w3-round" />
        <p>Controlling Blood Glucose (BG) during exercise is difficult for Type
          1 Diabetics (T1D). Recent research from Johns Hopkins University has
          led to significant findings on how aerobic and anaerobic exercise
          uniquely affect BG. Sugar Lift is here to help you Lift and control
          your Sugar.</p>

        <div class="w3-row-padding">
          <div class="w3-half w3-margin-bottom">
            <ul class="w3-ul w3-light-grey w3-center">
              <li class="w3-red w3-xlarge w3-padding-32">Aerobic</li>
              <li class="w3-padding-16">Tends to crash Blood Glucose
                (hypoglycemia)</li>

              <h2></h2>
              <span class="w3-opacity"></span>
              <li class="w3-light-grey w3-padding-24">
                <button
                  class="w3-button w3-red w3-padding-large w3-hover-black"
                >Learn More</button>
              </li>
            </ul>
          </div>

          <div class="w3-half">
            <ul class="w3-ul w3-light-grey w3-center">
              <li class="w3-red w3-xlarge w3-padding-32">Anaerobic</li>
              <li class="w3-padding-16">Tends to spike Blood Glucose
                (hyperglycemia)</li>
              <h2></h2>
              <span class="w3-opacity"></span>

              <li class="w3-light-grey w3-padding-24">
                <button
                  class="w3-button w3-red w3-padding-large w3-hover-black"
                >Learn More</button>
              </li>
            </ul>
          </div>
        </div>

        <!-- Contact -->
        <div class="w3-container" id="contact" style="margin-top:75px">
          <h1 class="w3-xxxlarge w3-text-red"><b>Contact.</b></h1>
          <hr style="width:50px;border:5px solid red" class="w3-round" />
          <p>Need some help? Fill out the form and fill me in with the details.</p>
          <form>
            <div class="w3-section">
              <label>Name</label>
              <input
                class="w3-input w3-border"
                type="text"
                name="Name"
                required
              />
            </div>
            <div class="w3-section">
              <label>Email</label>
              <input
                class="w3-input w3-border"
                type="text"
                name="Email"
                required
              />
            </div>
            <div class="w3-section">
              <label>Message</label>
              <input
                class="w3-input w3-border"
                type="text"
                name="Message"
                required
              />
            </div>
            <button
              type="submit"
              class="w3-button w3-block w3-padding-large w3-red w3-margin-bottom"
            >Send Message</button>
          </form>
        </div>

        <!-- End page content -->
      </div>

    </div>

    <!-- W3.CSS Container -->
    <div
      class="w3-light-grey w3-container w3-padding-32"
      style="margin-top:75px;padding-right:58px"
    ><p class="w3-right">Founded by Jay Lalwani</p></div>

<script>
// Script to open and close sidebar
function w3_open() {
  document.getElementById("mySidebar").style.display = "block";
  document.getElementById("myOverlay").style.display = "block";
}
 
function w3_close() {
  document.getElementById("mySidebar").style.display = "none";
  document.getElementById("myOverlay").style.display = "none";
}

// Modal Image Gallery
function onClick(element) {
  document.getElementById("img01").src = element.src;
  document.getElementById("modal01").style.display = "block";
  var captionText = document.getElementById("caption");
  captionText.innerHTML = element.alt;
}
</script>


  </body>
</html>
